!function(){function t(e,n,i){function s(r,a){if(!n[r]){if(!e[r]){var u="function"==typeof require&&require;if(!a&&u)return u(r,!0);if(o)return o(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var l=n[r]={exports:{}};e[r][0].call(l.exports,function(t){var n=e[r][1][t];return s(n||t)},l,l.exports,t,e,n,i)}return n[r].exports}for(var o="function"==typeof require&&require,r=0;r<i.length;r++)s(i[r]);return s}return t}()({1:[function(t,e,n){"use strict";function i(){for(var t="weird_get_top_level_domain=cookie",e=document.location.hostname.split("."),n=e.length-1;n>=0;n--){var i=e.slice(n).join(".");if(document.cookie=t+";domain=."+i+";",document.cookie.indexOf(t)>-1)return document.cookie=t.split("=")[0]+"=;domain=."+i+";expires=Thu, 01 Jan 1970 00:00:01 GMT;",i}}function s(){for(var t=f+"=",e=document.cookie.split(";"),n=0;n<e.length;n++){for(var i=e[n];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return i.substring(t.length,i.length)}}function o(t,e){var n=i(),s="path=/",o="domain="+n,r="expires="+e;return document.cookie=[f+"="+t,s,o,r].join("; "),r}function r(t){var e=void 0;try{e=s();var n=JSON.parse(decodeURIComponent(e));if(n.businessUnitId===t)return n}catch(i){if(e){var o="domain="+window.location.hostname.replace(/^.*\.([^.]+\.[^.]+)/,"$1");document.cookie=f+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;"+o}}}function a(t){if(t){if(!t.expiry){var e=100,n=864e5;t.expiry=new Date((new Date).getTime()+e*n).toUTCString()}return o(encodeURIComponent(JSON.stringify(t)),t.expiry)}}function u(t,e){for(e=t="";t++<36;e+=51*t&52?(15^t?8^Math.random()*(20^t?16:4):4).toString(16):"-");return e}function d(t,e){var n=r(t),i=18e5;return n&&(!n.sessionStart||+new Date<n.sessionStart+i)?void e(n,n.expiry):void c.xhrGet({url:h+"//widget.trustpilot.com/v1/ratios/"+t,success:function(i){var s=p(i,t);if(n&&n.testId===s.testId){n.session=u(),n.sessionStart=+new Date;var o=a(n);return e(n,o)}var r=a(s);return e(s,r)},error:function(){e(null)}})}var l=t("./constants.js").OFF,c=t("./xhr.js"),h="https:"===document.location.protocol?"https:":"http:",f="TrustboxSplitTest",p=function(t,e){if(!t||!t.groups)return null;for(var n=0,i=0,s=[],o=0;o<t.groups.length;o++)"number"==typeof t.groups[o].ratio&&(n+=t.groups[o].ratio,++i,s.push(t.groups[o]));if(0===i)return null;1===i&&n<1&&(s.push({name:l,ratio:1-n}),n=1);for(var r=0,a=Math.random()*n,d=s[0].name,c=[],h=0;h<s.length;h++)a>=r&&a<r+s[h].ratio&&(d=s[h].name),c.push(s[h].name),r+=s[h].ratio;return{allGroups:c,group:d,testId:t.testId,businessUnitId:e,session:u(),sessionStart:+new Date,anonymousId:u()}};e.exports={getABSettingsAsync:d}},{"./constants.js":2,"./xhr.js":8}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i="000000000000000000000000",s="OFF";n.EMPTY_WIDGET_ID=i,n.OFF=s},{}],3:[function(t,e,n){"use strict";function i(t){try{if(r)return;var e=document.createElement("script");e.setAttribute("type","application/ld+json"),e.innerHTML=JSON.stringify(t),document.head.appendChild(document.createComment("Added by Trustpilot")),document.head.appendChild(e),document.head.appendChild(document.createComment("/Added by Trustpilot")),r=!0}catch(n){}}function s(t,e,n,i,s){var o=["type="+t,"url="+encodeURIComponent(window.location.href),"templateId="+i,"locale="+n].join("&"),r=u+"//widget.trustpilot.com/data/jsonld/business-unit/"+e+"?"+o;a.xhrGet({url:r,success:function(t){t.url=document.location.href,s(t)},error:function(t){console.error(t)}})}function o(t,e,n,i,s,o,r){var d=e&&e.split("-")[0],l="5763ba71ba484803e8b222ba"===n||"5763bccae0a06d08e809ecbb"===n,c="/data/jsonld/business-unit/"+t+"/product",h="/data/jsonld/business-unit/"+t+"/product-imported",f=l?h:c,p=u+"//widget.trustpilot.com"+f+"?sku="+encodeURIComponent(s)+"&numberOfReviews="+(o||10)+"&productName="+i+"&language="+d+"&templateId="+n+"&url="+encodeURIComponent(window.location.origin+window.location.pathname);a.xhrGet({url:p,success:r,error:function(t){console.error(t)}})}var r=!1,a=t("./xhr.js"),u="https:"===document.location.protocol?"https:":"http:",d=function(t){return!r&&(t.schemaType?(s(t.schemaType,t.businessunitId,t.locale,t.templateId,i),!0):!(!t.name||!t.sku)&&(o(t.businessunitId,t.locale,t.templateId,t.name,t.sku,t.reviewnumber,i),!0))};e.exports=d},{"./xhr.js":8}],4:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=t("./constants"),a=t("./snippets"),u=i(a),d=t("./ab-settings"),l=t("./widget"),c=i(l),h=function(){function t(e,n,i){s(this,t),this.window=e,this.document=n,this.widgets=[],this.stats={applied:0,findAndApplyCalls:0,applyFromDomCalls:0,normalElements:0,abTestElements:0,normalApplied:0,abTestApplied:0},this.version=i}return o(t,[{key:"initialize",value:function(){var t=this;this.hasABTestElements()?(0,d.getABSettingsAsync)(this.businessUnitId,function(e,n){t.abSettings=e,t.sessionExpiry=n,t.findAndApplyWidgets()}):this.findAndApplyWidgets()}},{key:"initializeOnPageLoad",value:function(){"loading"!==this.document.readyState?this.initialize():this.document.addEventListener("DOMContentLoaded",this.initialize.bind(this))}},{key:"applyWidgetFromDomElement",value:function(t,e){var n=t.firstChild&&"IFRAME"===t.firstChild.tagName;n&&!e||this.createWidget(t,!n)}},{key:"findAndApplyWidgets",value:function(){var t=this;this.stats.findAndApplyCalls+=1;var e=this.widgetElements;e&&0!==e.length&&(this.stats.normalElements=e.filter(function(t){return!("group"in t.dataset)}).length,this.stats.abTestElements=e.filter(function(t){return"group"in t.dataset}).length,e.forEach(function(e){return t.createWidget(e)}))}},{key:"hasABTestElements",value:function(){return[].slice.call(this.widgetElements).some(function(t){return"group"in t.dataset})}},{key:"createWidget",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.checkWidgetDisplayAndUpdateDataset(t)){var n=t.dataset;e&&(0,u["default"])(n),this.removeWidget(t);var i="group"in n&&this.abSettings,s=i?{container:t,dataset:n,session:this.abSettings.session,anonymousId:this.abSettings.anonymousId,testId:this.abSettings.testId,sessionExpiry:this.sessionExpiry}:{container:t,dataset:n},o=new c["default"](s);return o.initialize(),this.stats.applied+=1,this.stats[i?"abTestApplied":"normalApplied"]+=1,this.stats.applyFromDomCalls+=1,this.widgets.push(o),o}return null}},{key:"checkWidgetDisplayAndUpdateDataset",value:function(t){var e=t.dataset;return!(this.abSettings&&"group"in e)||(this.abSettings.group===e.group||this.abSettings.group===r.OFF&&(e.templateId=r.EMPTY_WIDGET_ID,e.styleHeight="0",e.group=r.OFF,!0))}},{key:"removeWidget",value:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}},{key:"closePopups",value:function(){this.widgets.forEach(function(t){return t.closePopup()})}},{key:"businessUnitId",get:function(){return this.widgetElements[0].dataset.businessunitId}},{key:"widgetElements",get:function(){return[].slice.call(this.document.getElementsByClassName("trustpilot-widget"))}}]),t}();n["default"]=h},{"./ab-settings":1,"./constants":2,"./snippets":3,"./widget":6}],5:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t){var e=document.createElement("iframe");return e.style.position=t.position,e.style.zIndex=t.zindex,e.style.margin=t.margin,e.style.top=t.top,e.style.bottom=t.bottom,e.style.left=t.left,e.style.right=t.right,e.style.height=t.height,e.style.width=t.width,e.style.borderStyle=t.borderStyle,e.style.backgroundColor=t.backgroundColor,e.style.display=t.display,e.style.overflow=t.overflow,e.frameBorder=t.frameBorder,e.scrolling=t.scrolling,e.allowTransparency=t.allowTransparency,e.title="Customer reviews powered by Trustpilot",e.src=t.src,e}function o(t){t=t.toLowerCase();var e=/(px|\%)/i,n="";return t&&t.length>0&&(n=e.test(t)?t:t+"px"),n}Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u="index.html",d="https:"===document.location.protocol?"https:":"http:",l=d+"//widget.trustpilot.com",c=d+"//widget.trustpilot.com/trustboxes",h=function(){function t(e,n,s){i(this,t),this.name=e,this.dataset=n,this.iframeData=s||this.defaultIframeOptions}return a(t,[{key:"getIframeOptionsFromData",value:function(){var t=this.iframeData||{styles:{}};return r({},this.defaultIframeOptions,{position:t.styles.position||"",zindex:t.styles.zindex||"",margin:t.styles.margin||"",top:t.styles.top||"",bottom:t.styles.bottom||"",left:t.styles.left||"",right:t.styles.right||"",height:t.styles.height||"",width:t.styles.width||this.defaultIframeOptions.styles.width||"",display:t.show?"block":"none",src:this.baseUrl+t.source+this.queryString,borderStyle:this.defaultIframeOptions.styles.borderStyle,overflow:this.defaultIframeOptions.styles.overflow})}},{key:"initialize",value:function(t,e){this._iframe=s(this.getIframeOptionsFromData()),t.appendChild(this._iframe),this._iframe.addEventListener("load",e)}},{key:"sendMessage",value:function(t){this._iframe.contentWindow&&(t=JSON.stringify(t),this._iframe.contentWindow.postMessage(t,l))}},{key:"isInViewport",value:function(t){var e=this._iframe.getBoundingClientRect(),n={width:e.width||this._iframe.offsetWidth,height:e.height||this._iframe.offsetHeight};return e.top>=0&&e.left>=0&&e.bottom-n.height*t<=(window.innerHeight||document.documentElement.clientHeight)&&e.right-n.width*t<=(window.innerWidth||document.documentElement.clientWidth)}},{key:"setWidgetId",value:function(t){this.sendMessage({command:"setId",widgetId:t})}},{key:"setStyle",value:function(t){var e=this;Object.keys(t).forEach(function(n){var i=t[n];e._iframe.style[n]=i})}},{key:"hide",value:function(){this.setStyle({display:"none"})}},{key:"resizeHeight",value:function(t){"number"==typeof t&&0!==t&&(this._iframe.style.height=t+"px")}},{key:"dimensions",get:function(){return{height:o(this.dataset.styleHeight),width:o(this.dataset.styleWidth)}}},{key:"queryString",get:function(){var t=this,e=function(e){return e+"="+encodeURIComponent(t.dataset[e])},n=function(n){return Object.keys(t.dataset).filter(n).map(e)},i=["businessunitId","templateId"],s=n(function(t){return i.indexOf(t)!==-1}),o=n(function(t){return i.indexOf(t)===-1});return"?"+s.join("&")+"#"+o.join("&")}},{key:"templateId",get:function(){return this.dataset.templateId}},{key:"baseUrl",get:function(){return c+"/"+this.templateId+"/"}},{key:"defaultIframeOptions",get:function(){return{source:u,frameBorder:0,allowTransparency:"true",scrolling:"no",styles:{borderStyle:"none",backgroundColor:"transparent",display:"block",overflow:"hidden",height:this.dimensions.height,width:this.dimensions.width,position:"relative"},show:!0}}}]),t}();n["default"]=h},{}],6:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=t("./tracking"),a=i(r),u=t("./iframe"),d=i(u),l=function(){function t(e){var n=this,i=e.container,o=e.dataset,r=e.session,u=e.anonymousId,d=e.testId,l=e.sessionExpiry;s(this,t);var c={container:i,dataset:o,templateId:o.templateId,businessUnitId:o.businessunitId,locale:o.locale},h=function(t){throw"No "+t+" supplied for TrustBox"};Object.keys(c).forEach(function(t){c[t]||h(t)}),this.container=i,this.container.style.position="relative",this.dataset=o,this.iframes={},this.tracking=new a["default"](function(t){return n.iframes.main.sendMessage(t)},function(){return n.isInViewport(.5)},{session:r,group:o.group,sessionExpiry:l,anonymousId:u,testId:d,templateId:o.templateId}),this.stats={createIFrameCalls:0,iframeLoadEvents:0,events:{}}}return o(t,null,[{key:"generateId",value:function(){var t=this.usedIds,e=void 0;do e=Math.random();while(t.indexOf(e)!==-1);return this.usedIds.push(e)}}]),o(t,[{key:"initialize",value:function(){var t="https:"===document.location.protocol?"https:":"http:";this._widgetIFrameOrigin=t+"//widget.trustpilot.com",this.createIFrame("main"),this.attachMessageListener()}},{key:"handleCommand",value:function(t){var e=t.data,n=t.origin;try{var i="string"==typeof e?JSON.parse(e):e,s=["activate-old-brand","activate-new-brand"],o=s.indexOf(i.command)!==-1,r=o||n===this._widgetIFrameOrigin&&i.widgetId===this.id;return!!r&&this.widgetIframeMessageHandler(i)}catch(a){return!1}}},{key:"attachMessageListener",value:function(){window.addEventListener("message",this.handleCommand.bind(this),!1)}},{key:"widgetIframeMessageHandler",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.stats.events[t.command]=(this.stats.events[t.command]||0)+1;var i=t.name,s=t.style,o=t.height,r=this.iframes[i],a={createIFrame:function(){return e.createIFrame(i,t)},setStyle:function(){return r.setStyle(s)},loaded:function(){return e.iframes.main.sendMessage("loaded")},message:function(){return r.sendMessage(t)},"resize-height":function(){return e.getIframeOrMain(i).resizeHeight(o)},impression:function(){return e.tracking.initialize()},"activate-old-brand":function(){return e.switchBrand("old")},"activate-new-brand":function(){return e.switchBrand("new")}},u=a[t.command];return u?(u(),!0):(n(),!1)}},{key:"switchBrand",value:function(t){var e=this,n="new"===t?"activate-new-brand":"activate-old-brand";Object.keys(this.iframes).forEach(function(t){e.iframes[t].sendMessage({command:n})})}},{key:"createIFrame",value:function(t,e){var n=this,i=new d["default"](t,this.dataset,e);this.iframes[t]=i,this.stats.createIFrameCalls+=1,i.initialize(this.container,function(){i.setWidgetId(n.id),n.stats.iframeLoadEvents+=1})}},{key:"getIframeOrMain",value:function(t){return this.iframes[t]||this.iframes.main}},{key:"isInViewport",value:function(t){return this.iframes.main.isInViewport(t)}},{key:"closePopup",value:function(){if("popup"in this.iframes){var t={name:"main",command:"message",message:"popup toggled",visible:!1};this.iframes.main.sendMessage(t),this.iframes.popup.hide()}}},{key:"id",get:function(){return this._id||(this._id=this.constructor.generateId()),this._id}}]),t}();l.usedIds=[],n["default"]=l},{"./iframe":5,"./tracking":7}],7:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=t("../constants"),r=function(){function t(e,n,s){var o=s.session,r=s.sessionExpiry,a=s.group,u=s.anonymousId,d=s.testId,l=s.templateId;i(this,t),this.hasSentImpression=!1,this.hasSentViewTracking=!1,this.sendMessage=e,this.isTrustBoxVisible=n,this.session=o,this.group=a,this.sessionExpiry=r,this.anonymousId=u,this.testId=d,this.templateId=l}return s(t,[{key:"initialize",value:function(){this.sendImpressionData(),this.attachListener(),this.shouldDetachListener()}},{key:"getTrackingData",value:function(t){var e={command:t,url:window.document.URL,referrer:window.document.referrer,userAgent:window.navigator.userAgent,language:window.navigator.userLanguage||window.navigator.language,platform:window.navigator.platform};return this.session&&this.group&&(e.session=this.session,e.sessionExpiry=this.sessionExpiry),this.anonymousId&&(e.anonymousId=this.anonymousId),this.testId&&(e.testId=this.testId),e}},{key:"sendImpressionData",value:function(){if(!this.hasSentImpression){this.hasSentImpression=!0;var t=this.getTrackingData("impression-received");this.sendMessage(t)}}},{key:"sendVisibilityData",value:function(){if(!this.hasSentViewTracking){this.hasSentViewTracking=!0;var t=this.getTrackingData("trustbox-in-viewport");this.sendMessage(t)}}},{key:"attachListener",value:function(){var t=arguments,e=this,n=function(e,n){var i=void 0;return function(){var s=t,o=function(){i=null,e(s)};clearTimeout(i),i=setTimeout(o,n)}},i=n(function(){var t=e.templateId===o.EMPTY_WIDGET_ID,n=t||e.shouldDetachListener();n&&(window.removeEventListener("scroll",r,s),window.removeEventListener("resize",a,s))},100),s={passive:!0,capture:!1},r=window.addEventListener("scroll",i,s),a=window.addEventListener("resize",i,s);i()}},{key:"shouldDetachListener",value:function(){return!!this.hasSentViewTracking||(this.hasBeenVisible?(this.hasSentImpression&&this.sendVisibilityData(),!0):!!this.isTrustBoxVisible()&&(this.hasSentImpression?(this.sendVisibilityData(),!0):(this.hasBeenVisible=!0,!0)))}}]),t}();n["default"]=r},{"../constants":2}],8:[function(t,e,n){"use strict";function i(t){try{return JSON.parse(t.responseText)}catch(e){return t.responseText}}function s(t){var e=new window.XMLHttpRequest;e.open("GET",t.url,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.onreadystatechange=function(){4===e.readyState&&(e.status>=200&&e.status<300?t.success(i(e)):t.error&&t.error(i(e)))},e.send()}e.exports={xhrGet:s}},{}],9:[function(t,e,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(e){try{!function(){var n=t("./lib/widget-management.js")["default"];window.Trustpilot=window.Trustpilot||{loadFromElement:function(t,e){return this.Modules.WidgetManagement&&this.Modules.WidgetManagement.applyWidgetFromDomElement(t,e)}},window.Trustpilot.Modules=window.Trustpilot.Modules||{},window.Trustpilot.Modules.WidgetManagement?window.Trustpilot.Modules.WidgetManagement.version!==e&&console.log("Detected legacy TrustBox bootstrap with version:",window.Trustpilot.Modules.WidgetManagement.version,", current:",e):(window.Trustpilot.Modules.WidgetManagement=new n(window,document,e),window.Trustpilot.Modules.WidgetManagement.initializeOnPageLoad()),window.addEventListener("click",function(){window.Trustpilot.Modules.WidgetManagement.closePopups()})}()}catch(n){!function(){function t(t){console.error("Error on bootstrap:"+t);var n="//widget.trustpilot.com/feedback/report-error",i=["error="+encodeURIComponent(t),"uri="+encodeURIComponent(document.URL),"bootstrapVersion="+e].join("&"),s=document.createElement("img");s.src=n+"?"+i}try{t("object"===("undefined"==typeof n?"undefined":i(n))?n.message:n)}catch(n){console.error("Error on error reporting method:"+n)}}()}}("1.233.0")},{"./lib/widget-management.js":4}]},{},[9]);
//# sourceMappingURL=tp.widget.bootstrap.min.js.map
