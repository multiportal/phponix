var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,f){a!=Array.prototype&&a!=Object.prototype&&(a[e]=f.value)};
$jscomp.getGlobal=function(a){a=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var e=0;e<a.length;++e){var f=a[e];if(f&&f.Math==Math)return f}return globalThis};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,e,f,l){if(e){f=$jscomp.global;a=a.split(".");for(l=0;l<a.length-1;l++){var c=a[l];c in f||(f[c]={});f=f[c]}a=a[a.length-1];l=f[a];e=e(l);e!=l&&null!=e&&$jscomp.defineProperty(f,a,{configurable:!0,writable:!0,value:e})}};
$jscomp.arrayIteratorImpl=function(a){var e=0;return function(){return e<a.length?{done:!1,value:a[e++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var e="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return e?e.call(a):$jscomp.arrayIterator(a)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function e(){this.batch_=null}function f(a){return a instanceof c?a:new c(function(k,c){k(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;e.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var k=this;this.asyncExecuteFunction(function(){k.executeBatch_()})}this.batch_.push(a)};var l=$jscomp.global.setTimeout;e.prototype.asyncExecuteFunction=function(a){l(a,0)};e.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var p=0;p<a.length;++p){var c=a[p];a[p]=null;try{c()}catch(m){this.asyncThrow_(m)}}}this.batch_=null};e.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var c=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var k=this.createResolveAndReject_();try{a(k.resolve,k.reject)}catch(n){k.reject(n)}};c.prototype.createResolveAndReject_=function(){function a(a){return function(b){e||(e=!0,a.call(c,b))}}var c=this,e=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};c.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof c)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var k=null!=a;break a;case "function":k=!0;break a;default:k=!1}k?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};c.prototype.resolveToNonPromiseObj_=function(a){var k=void 0;try{k=a.then}catch(n){this.reject_(n);return}"function"==typeof k?
this.settleSameAsThenable_(k,a):this.fulfill_(a)};c.prototype.reject_=function(a){this.settle_(2,a)};c.prototype.fulfill_=function(a){this.settle_(1,a)};c.prototype.settle_=function(a,c){if(0!=this.state_)throw Error("Cannot settle("+a+", "+c+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=c;this.executeOnSettledCallbacks_()};c.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)g.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var g=new e;c.prototype.settleSameAsPromise_=function(a){var c=this.createResolveAndReject_();a.callWhenSettled_(c.resolve,c.reject)};c.prototype.settleSameAsThenable_=function(a,c){var e=this.createResolveAndReject_();try{a.call(c,e.resolve,e.reject)}catch(m){e.reject(m)}};c.prototype.then=function(a,e){function f(a,d){return"function"==typeof a?function(d){try{k(a(d))}catch(t){b(t)}}:d}var k,b,d=new c(function(a,d){k=a;b=d});this.callWhenSettled_(f(a,k),f(e,b));return d};
c.prototype.catch=function(a){return this.then(void 0,a)};c.prototype.callWhenSettled_=function(a,c){function e(){switch(f.state_){case 1:a(f.result_);break;case 2:c(f.result_);break;default:throw Error("Unexpected state: "+f.state_);}}var f=this;null==this.onSettledCallbacks_?g.asyncExecute(e):this.onSettledCallbacks_.push(e)};c.resolve=f;c.reject=function(a){return new c(function(c,e){e(a)})};c.race=function(a){return new c(function(c,e){for(var g=$jscomp.makeIterator(a),b=g.next();!b.done;b=g.next())f(b.value).callWhenSettled_(c,
e)})};c.all=function(a){var e=$jscomp.makeIterator(a),g=e.next();return g.done?f([]):new c(function(a,b){function d(b){return function(d){h[b]=d;c--;0==c&&a(h)}}var h=[],c=0;do h.push(void 0),c++,f(g.value).callWhenSettled_(d(h.length-1),b),g=e.next();while(!g.done)})};return c},"es6","es3");
$jscomp.polyfill("Promise.prototype.finally",function(a){return a?a:function(a){return this.then(function(e){return Promise.resolve(a()).then(function(){return e})},function(e){return Promise.resolve(a()).then(function(){throw e;})})}},"es9","es3");
embedded_svc.defineFeature("LiveAgent",function(a){function e(a,d){this.name=a;this.data=d}function f(b){this.liveAgentAPI=b;this.running=!1;this.pingScript=this.pingTimeoutTimer=void 0;this.sid=a.getCookie("liveagent_sid")}function l(){this.createElements();this.registerMessageHandlers()}function c(){this.visitCount=0;this.originalReferrer=void 0;this.pages=[]}function g(){this.connection=new f(this);this.fileTransfer=new l;this.visitorInfo=new c;this.browserSessionInfo={};a.setDefaultButtonText("LiveAgent",
"Chat with an Expert","Agent Offline","Live chat:");a.addDefaultSetting("avatarImgURL","");a.addDefaultSetting("prechatBackgroundImgURL","");a.addDefaultSetting("waitingStateBackgroundImgURL","");a.addDefaultSetting("smallCompanyLogoImgURL","");a.addDefaultSetting("headerBackgroundURL","");a.addDefaultSetting("extraPrechatInfo",[]);a.addDefaultSetting("extraPrechatFormDetails",[]);a.addDefaultSetting("agentAvailableOnButtonClick",!1);a.settings.isOfflineSupportEnabled&&(a.settings.offlineSupportMinimizedText=
a.settings.offlineSupportMinimizedText||"Contact Us");a.addMessageHandler("liveagent.chatCanceledOnDifferentTab",function(){a.fireEvent("liveagent.chatCanceledOnDifferentTab")});a.addEventHandler("error",this.disconnect.bind(this));a.addEventHandler("sessionDataRetrieved",function(b){n=embedded_svc.liveAgentAPI.constructChatSettingsEndpointURL();b.CHASITOR_SERIALIZED_KEY?(a.settings.agentAvailableOnButtonClick=!0,this.ping()):(embedded_svc.menu||embedded_svc.settings.disableDeploymentDataPrefetch||
embedded_svc.liveAgentAPI.getChatSettings(),a.loadFeatureScript("Invite",function(){embedded_svc.liveAgentAPI.getButtonSettings();document.querySelector("style#inert-style")||a.loadScriptFromDirectory("utils","inert")}));this.visitorInfo.initialize(b);return!!b.CHASITOR_SERIALIZED_KEY}.bind(this));a.addEventHandler("beforeCreate",function(){a.settings.visitorInfo=this.visitorInfo.getInfo()}.bind(this));a.addEventHandler("validateInit",function(a){if("string"!==typeof a.baseLiveAgentURL)throw Error("Invalid Live Agent chat URL: "+
a.baseLiveAgentURL);if("string"!==typeof a.baseLiveAgentContentURL)throw Error("Invalid Live Agent content URL: "+a.baseLiveAgentContentURL);if(!this.isButtonId(a.buttonId))throw Error("Invalid ButtonId Parameter Value: "+a.buttonId);if(!this.isDeploymentId(a.deploymentId))throw Error("Invalid DeploymentId Parameter Value: "+a.deploymentId);return!0}.bind(this));a.loadStorageScript("Chasitor");a.registerStorageKeys("CHASITOR_SERIALIZED_KEY LA_ESW_CHAT_SCROLL_POSITION LA_ESW_UNSEEN_MESSAGES LA_ESW_SHOW_QUEUE_POSITION LA_VISITOR_INFO LA_ESW_FILE_TOKEN LA_ESW_FILE_UPLOAD_SERVLET_URL CHATBOT_FOOTER_MENU".split(" "));
"LiveAgent"===a.settings.entryFeature&&this.updateButton()}function k(a){var b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h=String(a);if("undefined"!==typeof window.JSON)return window.JSON.parse(h);b.lastIndex=0;b.test(a)&&(h=h.replace(b,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return eval("("+h+")");throw Error("Error during JSON.parse");}function p(b){var d,h=k(b.inviteRules);(d=document.getElementById("snapins_invite"))&&a.inviteAPI&&"Custom"!==b.inviteRenderer&&(a.inviteAPI.inviteButton.addTracker(d,b),a.inviteAPI.inviteButton.setRules(h.rules,h.filter),a.inviteAPI.inviteButton.setOnlineState(b.isAvailable))}var n,m=0;f.prototype.send=function(b,d){var h=d||{};d="Visitor";var c="",e=!1;if(this.pingScript)this.onError("SCRT did not handle response before sending another message.");
else{1<b.length?(d="System",c="MultiNoun",h.nouns="",e=!0):c=b[0].name;var f=a.settings.baseLiveAgentURL+"/rest/"+d+"/"+c+".jsonp?";b.forEach(function(a){e&&(h.nouns+=a.name+",");h[a.name+".prefix"]="Visitor";Object.getOwnPropertyNames(a.data).forEach(function(b){h[a.name+"."+b]=a.data[b]})});e&&(h.nouns=h.nouns.substr(0,h.nouns.length-1));Object.getOwnPropertyNames(h).forEach(function(a){f+=a+"="+h[a]+"&"});f+="callback=embedded_svc.liveAgentAPI.connection.handlePing&deployment_id="+a.settings.deploymentId+
"&org_id="+a.settings.orgId+"&version=48";b=document.createElement("script");b.type="text/javascript";b.src=f;this.pingScript=document.body.appendChild(b);this.pingTimeoutTimer=window.setTimeout(function(){this.onError("Server failed to respond.")}.bind(this),5E3)}};f.prototype.handlePing=function(a){this.pingTimeoutTimer&&(clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=void 0);this.running=!0;a.messages.forEach(function(a){this.messageHandler(a.type,a.message)}.bind(this));this.onSuccess();
this.pingScript&&(document.body.removeChild(this.pingScript),this.pingScript=void 0)};f.prototype.messageHandler=function(b,d){switch(b){case "Availability":this.liveAgentAPI.handleAvailability(d);break;case "SwitchServer":this.liveAgentAPI.handleSwitchServer(d);break;case "Settings":this.liveAgentAPI.handleSettings(d);break;default:a.log("Unexpected message of type "+b+": "+JSON.stringify(d))}};f.prototype.onSuccess=function(a){a=a||5E4;this.pingTimer&&clearTimeout(this.pingTimer);this.pingTimer=
window.setTimeout(this.liveAgentAPI.ping.bind(this.liveAgentAPI),a)};f.prototype.onError=function(b){a.error(b)};l.prototype.registerMessageHandlers=function(){a.addMessageHandler("liveagent.fileTransfer.openFileSelector",function(){this.openFileSelector()}.bind(this));a.addMessageHandler("liveagent.fileTransfer.uploadFile",function(a){this.uploadFile(a)}.bind(this));a.addMessageHandler("liveagent.fileTransfer.resetFileSelector",function(){this.resetFileSelector()}.bind(this))};l.prototype.openFileSelector=
function(){document.getElementById("fileSelector").click()};l.prototype.handleFileSelectorChange=function(){var a=document.getElementById("fileSelector").files[0];embedded_svc.liveAgentAPI.sendFileInfo(a)};l.prototype.uploadFile=function(a){var b=document.getElementById("fileUploadForm");b.action=a.url;b.submit();this.resetFileSelector()};l.prototype.resetFileSelector=function(){document.getElementById("fileSelector").value=""};l.prototype.createElements=function(){var a=document.createElement("form"),
d=document.createElement("input"),h=document.createElement("input"),c=document.createElement("iframe");a.id="fileUploadForm";a.enctype="multipart/form-data";a.method="post";a.target="fileUploadIframe";d.type="file";d.id="fileSelector";d.name="file";d.style.display="none";d.onchange=this.handleFileSelectorChange;h.name="filename";h.type="hidden";c.id="fileUploadIframe";c.name="fileUploadIframe";c.title="FileUploadFrame";c.style.display="none";a.appendChild(d);a.appendChild(h);document.body.appendChild(a);
document.body.appendChild(c)};c.prototype.initialize=function(a){a&&a.LA_VISITOR_INFO?(a=JSON.parse(a.LA_VISITOR_INFO),this.visitCount=a.visitCount,this.pages=a.pages,this.originalReferrer=a.originalReferrer||document.referrer):this.originalReferrer=document.referrer;this.visitCount+=1;this.addCurrentPage();this.serialize()};c.prototype.serialize=function(){var a=JSON.stringify({visitCount:this.visitCount,originalReferrer:this.originalReferrer,pages:this.pages});embedded_svc?embedded_svc.setSessionData("LA_VISITOR_INFO",
a):window.sessionStorage.setItem("LA_VISITOR_INFO",a)};c.prototype.getInfo=function(){return{visitCount:this.visitCount,originalReferrer:this.originalReferrer,pages:this.pages}};c.prototype.addCurrentPage=function(){var a=window.location.href;this.pages.forEach(function(b,c){b.location===a&&this.pages.splice(c,1)}.bind(this));this.pages.unshift({location:a,time:(new Date).getTime()})};g.prototype.ping=function(){var b={},d=[new e("Availability",{ids:"["+a.settings.buttonId+"]"})];a.log("Pinging server");
this.connection.pingTimer=void 0;b.sid=this.sid;b.r=(new Date).getMilliseconds();this.connection.send(d,b)};g.prototype.getChatSettings=function(){var a=document.createElement("script");a.type="text/javascript";a.src=n;document.body.appendChild(a);m+=1};g.prototype.constructChatSettingsEndpointURL=function(){var a=embedded_svc.settings.language,d=embedded_svc.settings.eswConfigDevName;var c="?Settings.prefix=EmbeddedService&org_id="+embedded_svc.settings.orgId;c=c+("&EmbeddedServiceConfig.configName="+
d)+"&callback=embedded_svc.liveAgentAPI.handleChatSettings&version=48";"string"===typeof a&&0<a.trim().length&&(c+="&EmbeddedServiceConfig.language="+a);return embedded_svc.settings.baseLiveAgentURL+"/rest/EmbeddedService/EmbeddedServiceConfig.jsonp"+c};g.prototype.handleChatSettings=function(a){a.messages.forEach(function(a){"EmbeddedServiceConfig"===a.type?embedded_svc.config=a.message:"SwitchServer"===a.type?(embedded_svc.utils.warning("[Chat] Your org has been migrated on the Service Cloud Real Time servers. Consider regenerating the snippet for this page."),
embedded_svc.settings.baseLiveAgentURL=a.message.newUrl,m=0,n=embedded_svc.liveAgentAPI.constructChatSettingsEndpointURL(),embedded_svc.liveAgentAPI.getChatSettings()):"EmbeddedServiceError"===a.type||"Error"===a.type?1<=m||"EmbeddedServiceError"===a.type&&!a.message.shouldRetry?embedded_svc.utils.error("[Chat] "+a.type+" from jsonp call: "+a.message.text):(embedded_svc.log("[Chat] Getting chat settings failed. Retrying..Attempt:"+m),embedded_svc.liveAgentAPI.getChatSettings()):embedded_svc.utils.error("[Chat] Unexpected message type from jsonp call:"+
a.type)})};g.prototype.getButtonSettings=function(){var b=[],d={};this.sid&&(d.sid=this.sid,d.r=(new Date).getMilliseconds(),a.log("Reusing existing session."));b.push(new e("Settings",{buttonIds:"["+a.settings.buttonId+"]",updateBreadcrumb:1}));this.connection.send(b,d)};g.prototype.handleAvailability=function(b){a.log("Agent Available: "+JSON.stringify(b));b.results.forEach(function(b){b=b.isAvailable;"LiveAgent"===a.settings.entryFeature&&(a.settings.agentAvailableOnButtonClick=b,this.updateButton(b),
a.inviteAPI&&a.inviteAPI.inviteButton.getTracker()&&a.inviteAPI.inviteButton.setOnlineState(b))}.bind(this))};g.prototype.handleSettings=function(b){var d,c;b.buttons.forEach(function(b){b.id===a.settings.buttonId&&(d=b.isAvailable,"Invite"===b.type&&(c=b))});a.log("Agent Available: "+JSON.stringify(d));"LiveAgent"===a.settings.entryFeature&&(a.settings.agentAvailableOnButtonClick=d,this.updateButton(d));c&&p(c);embedded_svc.utils.fireEvent("onSettingsCallCompleted",void 0,{isAgentAvailable:d})};
g.prototype.handleSwitchServer=function(b){b=b.newUrl;a.log("Detected new Live Agent url: "+b);a.settings.baseLiveAgentURL=b;a.log("Immediately re-pinging server with new Live Agent url");window.setTimeout(function(){this.connection.onSuccess(1)}.bind(this),1);this.getButtonSettings()};g.prototype.disconnect=function(){a.log("Disconnecting from Live Agent");this.connection.running=!1};g.prototype.isButtonId=function(b){return"573"===a.getKeyPrefix(b)};g.prototype.isDeploymentId=function(b){return"572"===
a.getKeyPrefix(b)};g.prototype.sendFileInfo=function(a){var b=document.createEvent("CustomEvent");b.initCustomEvent("sendFileInfo",!0,!1,{name:a.name,size:a.size});window.dispatchEvent(b)};g.prototype.sendCustomEvent=function(b,c){var d={};d.type=b;d.data=c;a.postMessage("chasitor.sendCustomEvent",d)};g.prototype.getCustomEvents=function(b){a.addMessageHandler("liveagent.getCustomEventsResult",b);a.postMessage("chasitor.getCustomEvents")};g.prototype.addCustomEventListener=function(b,c){a.addMessageHandler("liveagent.customEventReceived",
c);a.postMessage("chasitor.addCustomEventListener",b)};g.prototype.getSessionId=function(){return this.sid};g.prototype.updateButton=function(b){a.settings.isOfflineSupportEnabled&&!b?(a.isButtonDisabled=!1,a.setHelpButtonText(a.settings.offlineSupportMinimizedText)):a.isButtonDisabled=!b};g.prototype.startChat=function(b){if("function"!==typeof Promise)a.loadScriptFromDirectory("common","promisepolyfill",function(){return a.liveAgentAPI.startChat(b)},!0);else return(new Promise(function(c,e){var d;
try{(d=document.querySelector(".embeddedServiceSidebar"))?d.classList.contains("sidebarMinimized")?d.dispatchEvent(new CustomEvent("embeddedservicemaximizechat",{detail:{resolve:c,reject:e}})):d.classList.contains("sidebarMaximized")&&c("Embedded Service component is already maximized."):a.bootstrapEmbeddedService({chatAPISettings:b}).then(function(){a.liveAgentAPI.startChat.bind(a,b);c("Embedded Service application and component bootstrapped")}).catch(function(a){e(a)})}catch(q){e(q)}})).then(function(c){a.log("[Start Chat API] "+
c);(a.util.isChannelMenuContext()||a.menu)&&a.menu.hideButtonAndMenu();return(new Promise(function(a,c){try{var d=document.querySelector(".embeddedServiceLiveAgentSidebarFeature");var e=document.querySelector(".embeddedServiceSidebarState");d?e.classList.contains("embeddedServiceLiveAgentStateWaiting")||e.classList.contains("embeddedServiceLiveAgentStateChat")?a("Restricted from starting chat in current state. Chat request will not fire."):(d.dispatchEvent(new CustomEvent("embeddedservicestartchat",
{detail:{data:b?embedded_svc.validateStartChatAttributes(b):{},resolve:a,reject:c}})),a("Start Chat requested.")):!d&&document.getElementsByClassName("embeddedServiceSidebarDialogState")?a("Restricted from starting a chat in current state. Chat request will not fire."):a("Embedded Service sidebar feature not rendered. Start Chat was not called.")}catch(u){c(u)}})).then(function(b){a.log("[Start Chat API] "+b)}).catch(function(b){a.error("[Start Chat API] Error starting chat: "+b)})}).catch(function(b){a.error("[Start Chat API] Error bootstrapping/maximizing chat: "+
b)})};g.prototype.endChat=function(){if("function"!==typeof Promise)a.loadScriptFromDirectory("common","promisepolyfill",function(){return this.endChat()}.bind(this),!0);else return(new Promise(function(b,c){var d=["embeddedServiceLiveAgentStateWaiting","embeddedServiceLiveAgentStateChat","embeddedServiceSidebarDialogState"],e;try{(e=document.querySelector(".embeddedServiceSidebarState"))?d.some(function(a){return e.classList.contains(a)})?(e.dispatchEvent(new CustomEvent("embeddedserviceendchat",
{detail:{resolve:b,reject:c}})),b("Chat ended.")):(a.deleteSessionData(["ESW_IS_MINIMIZED"]),b("Embedded Service is not in active chat state.")):b("Embedded Service application state is not rendered on this page.")}catch(q){c(q)}})).then(function(b){a.log("[End Chat API] "+b);return(new Promise(function(b,c){var d;try{(d=document.querySelector(".embeddedServiceSidebar"))?(d.dispatchEvent(new CustomEvent("embeddedservicedestroysidebar",{detail:{resolve:b,reject:c}})),a.deleteSessionData(["ESW_IS_MINIMIZED",
"SCROLL_ENABLED","LA_ESW_CHAT_SCROLL_POSITION","CHATBOT_FOOTER_MENU","LA_ESW_SHOW_QUEUE_POSITION"]),b("Embedded Service component destroyed.")):b("Embedded Service component is not rendered on this page.")}catch(q){c(q)}finally{d&&d.remove()}})).then(function(b){a.log("[End Chat API] "+b);a.deleteSessionData(["CHASITOR_SERIALIZED_KEY","MASTER_DEPLOYMENT_ID","ACTIVE_CHAT_SESSIONS"]);embedded_svc.postMessage("chasitor.decrementActiveChatSession",embedded_svc.settings.deploymentId);sessionStorage.removeItem(a.settings.storageDomain+
"MASTER_DEPLOYMENT_ID");a.deleteSessionData(["ESW_IS_MINIMIZED","SCROLL_ENABLED","LA_ESW_CHAT_SCROLL_POSITION","CHATBOT_FOOTER_MENU","LA_ESW_SHOW_QUEUE_POSITION"]);a.menu&&a.menu.settings.displayChannelMenu&&a.menu.showButtonAndMenu();!a.menu&&a.settings.displayHelpButton&&a.showHelpButton()}).catch(function(b){a.error("[End Chat API] Error destroying sidebar: "+b)})}).catch(function(b){a.error("[End Chat API] Error ending chat: "+b)}).finally(function(){a.log("[End Chat API] Finished executing End Chat API")})};
g.prototype.clearSession=function(){if("function"!==typeof Promise)a.loadScriptFromDirectory("common","promisepolyfill",function(){return this.clearSession()}.bind(this),!0);else return a.liveAgentAPI.endChat().then(function(){return(new Promise(function(b,c){var d;try{(d=document.getElementById("esw_storage_iframe"))?-1===a.settings.enabledFeatures.indexOf("LiveAgent")?c("Embedded Service deployment does not have the LiveAgent feature enabled."):(a.addMessageHandler("session.deletedAllSessionData",
function(){b("Successfully deleted all tracked ESW storage keys.")}),a.postMessage("chasitor.cancelChat"),a.postMessage("chasitor.endChat"),a.deleteSessionData(["CHASITOR_SERIALIZED_KEY","ACTIVE_CHAT_SESSIONS","LA_VISITOR_INFO","MASTER_DEPLOYMENT_ID","CHASITOR_EVENTS"]),a.deleteSessionData(["ACTIVE_CHAT_SESSIONS"],!0),sessionStorage.removeItem(a.settings.storageDomain+"MASTER_DEPLOYMENT_ID"),a.deleteSessionData(a.storageKeys),a.postMessage("session.deleteAllKeys",a.settings.storageDomain)):b("Salesforce iframe not present on this page.")}catch(r){c(r)}})).then(function(b){a.log("[Clear Session API] "+
b)}).catch(function(b){a.error("[Clear Session API] Error deleting session keys or iframe: "+b)})}).catch(function(b){a.error("[Clear Session API] Error clearing session: "+b)}).finally(function(){a.log("[Clear Session API] Finished executing Clear Session API")})};a.liveAgentAPI=new g});
